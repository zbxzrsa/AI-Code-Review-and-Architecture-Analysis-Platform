# 统一状态管理规范

目标：为所有UI异步数据与交互建立一致的状态语义与展示策略，提升可理解性与可维护性。

## 状态语义

- `idle`：未发起请求或初始态，不展示进度与错误。
- `loading`：进行中，应展示明确进度或占位内容（骨架屏/Spinner）。
- `error`：失败态，展示清晰原因与可操作的恢复路径（重试、反馈）。
- `empty`：成功但空数据，展示引导与推荐内容。
- `success`：成功态，可展示完成反馈或进度达成。

## 管理与Hook

- 使用 `useAsyncStatus` 统一管理状态与竞态，支持超时处理与自动触发。
- 每个页面的数据入口应返回 `{ status, data, error, run }`，并据此渲染。

## 展示组件

- 使用 `StatusBanner` 统一各状态展示，以保持视觉与文案一致。
- 错误捕获使用 `ErrorBoundary` 包裹关键区域，并提供可刷新或反馈的Fallback。

## 加载与空状态

- 加载超过 2s 显示更明确的说明，超过 8s 提示可能失败并提供重试。
- 空状态展示行动引导（创建、探索、修改筛选）与推荐内容链接。

## 错误规范

- 错误信息面向用户，提供下一步操作（重试、联系支持、返回首页）。
- 错误边界覆盖关键渲染树，避免整页崩溃，优先局部降级。

## 性能与并发

- 对同一路径的并发操作需要串行或去重；请求超时需反馈并可取消。
- 实时更新采用节流/防抖，避免频繁重渲染导致卡顿。

## 诊断与度量

- 启用 `UIDiagnosticsOverlay` 开发叠层进行视口与样式诊断（Ctrl+Shift+D）。
- 使用 `uxMetrics` 采集 LCP/CLS/FCP/TTFB 并上报，建立UX基线。